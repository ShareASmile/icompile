This code will generate any amount of bytes, in human readable Hex-characters,
using either <code>random_bytes</code>, <code>mcrypt_create_iv</code> or <code>openssl_random_pseudo_bytes</code> (all with added entropy), an additional, in-case of some sort of error or an old or lack of crypto-libraries PHP instance, there is a <code>mt_rand</code>-based on fallback.

<pre><span style='color:#5f5035;'>&lt;?php</span><span style='color:#000000;'></span>
<span style='color:#797997;'>$get_random_bytes</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#800000;font-weight:bold; '>function</span><span style='color:#808030;'>(</span><span style='color:#797997;'>$length</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#008c00;'>64</span><span style='color:#808030;'>)</span><span style='color:#800080;'>{</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;</span><span style='color:#797997;'>$length</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#400000;'>max</span><span style='color:#808030;'>(</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>,</span><span style='color:#000000;'> </span><span style='color:#797997;'>$length</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span><span style='color:#000000;'> </span><span style='color:#696969;'>/* valid input, at-least 1 byte. */</span><span style='color:#000000;'></span>
<span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;</span><span style='color:#797997;'>$result</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#0f4d75;'>true</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#808030;'>=</span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#400000;'>function_exists</span><span style='color:#808030;'>(</span><span style='color:#0000e6;'>'random_bytes'</span><span style='color:#808030;'>)</span><span style='color:#000000;'>                 </span><span style='color:#800080;'>?</span><span style='color:#000000;'>  </span><span style='color:#400000;'>bin2hex</span><span style='color:#808030;'>(</span><span style='color:#000000;'>random_bytes</span><span style='color:#808030;'>(</span><span style='color:#797997;'>$length</span><span style='color:#808030;'>)</span><span style='color:#808030;'>)</span><span style='color:#000000;'>                          </span><span style='color:#800080;'>:</span><span style='color:#000000;'> </span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#0f4d75;'>true</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#808030;'>=</span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#400000;'>function_exists</span><span style='color:#808030;'>(</span><span style='color:#0000e6;'>'mcrypt_create_iv'</span><span style='color:#808030;'>)</span><span style='color:#000000;'>             </span><span style='color:#800080;'>?</span><span style='color:#000000;'>  </span><span style='color:#400000;'>bin2hex</span><span style='color:#808030;'>(</span><span style='color:#400000;'>mcrypt_create_iv</span><span style='color:#808030;'>(</span><span style='color:#797997;'>$length</span><span style='color:#808030;'>,</span><span style='color:#000000;'> </span><span style='color:#7d0045;'>MCRYPT_DEV_URANDOM</span><span style='color:#808030;'>)</span><span style='color:#808030;'>)</span><span style='color:#000000;'>  </span><span style='color:#800080;'>:</span><span style='color:#000000;'> </span><span style='color:#696969;'>/* might give false on error */</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#0f4d75;'>true</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#808030;'>=</span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#400000;'>function_exists</span><span style='color:#808030;'>(</span><span style='color:#0000e6;'>'openssl_random_pseudo_bytes'</span><span style='color:#808030;'>)</span><span style='color:#000000;'>  </span><span style='color:#800080;'>?</span><span style='color:#000000;'>  </span><span style='color:#400000;'>bin2hex</span><span style='color:#808030;'>(</span><span style='color:#000000;'>openssl_random_pseudo_bytes</span><span style='color:#808030;'>(</span><span style='color:#797997;'>$length</span><span style='color:#808030;'>,</span><span style='color:#000000;'> </span><span style='color:#0f4d75;'>true</span><span style='color:#808030;'>)</span><span style='color:#808030;'>)</span><span style='color:#000000;'>     </span><span style='color:#800080;'>:</span><span style='color:#000000;'> </span><span style='color:#696969;'>/* might give false on error */</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#0f4d75;'>false</span><span style='color:#000000;'> </span><span style='color:#696969;'>/* fallback */</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#800080;'>;</span><span style='color:#000000;'></span>
<span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;</span><span style='color:#696969;'>/* in case of FALSE (because of function-error or fallback) we will be using "simpler" random */</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;</span><span style='color:#797997;'>$result</span><span style='color:#000000;'> </span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#0f4d75;'>false</span><span style='color:#000000;'> </span><span style='color:#808030;'>!</span><span style='color:#808030;'>=</span><span style='color:#808030;'>=</span><span style='color:#000000;'> </span><span style='color:#797997;'>$result</span><span style='color:#000000;'> </span><span style='color:#800080;'>?</span><span style='color:#000000;'> </span><span style='color:#797997;'>$result</span><span style='color:#000000;'> </span><span style='color:#800080;'>:</span><span style='color:#000000;'> </span><span style='color:#400000;'>substr</span><span style='color:#808030;'>(</span><span style='color:#000000;'>                                                </span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#400000;'>preg_replace_callback</span><span style='color:#808030;'>(</span><span style='color:#0000e6;'>'</span><span style='color:#800000;'>#</span><span style='color:#0000e6;'>@</span><span style='color:#800000;'>#</span><span style='color:#0000e6;'>'</span><span style='color:#808030;'>,</span><span style='color:#000000;'> </span><span style='color:#800000;font-weight:bold; '>function</span><span style='color:#808030;'>(</span><span style='color:#808030;'>)</span><span style='color:#800080;'>{</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#800000;font-weight:bold; '>return</span><span style='color:#000000;'> </span><span style='color:#400000;'>dechex</span><span style='color:#808030;'>(</span><span style='color:#400000;'>mt_rand</span><span style='color:#808030;'>(</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>,</span><span style='color:#000000;'> </span><span style='color:#008c00;'>16</span><span style='color:#808030;'>)</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span><span style='color:#000000;'> </span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#800080;'>}</span><span style='color:#808030;'>,</span><span style='color:#000000;'> </span><span style='color:#400000;'>str_repeat</span><span style='color:#808030;'>(</span><span style='color:#0000e6;'>'@'</span><span style='color:#808030;'>,</span><span style='color:#000000;'> </span><span style='color:#797997;'>$length</span><span style='color:#000000;'> </span><span style='color:#808030;'>*</span><span style='color:#000000;'> </span><span style='color:#008c00;'>2</span><span style='color:#808030;'>)</span><span style='color:#808030;'>)</span><span style='color:#000000;'>      </span><span style='color:#696969;'>/*64 bytes are 128 characters*/</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#808030;'>,</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#808030;'>(</span><span style='color:#808030;'>-</span><span style='color:#008c00;'>1</span><span style='color:#000000;'> </span><span style='color:#808030;'>*</span><span style='color:#000000;'> </span><span style='color:#797997;'>$length</span><span style='color:#000000;'> </span><span style='color:#808030;'>*</span><span style='color:#000000;'> </span><span style='color:#008c00;'>2</span><span style='color:#808030;'>)</span><span style='color:#000000;'>                    </span><span style='color:#696969;'>/*trim - make sure exactly 128 characters (for example, if $length is 64)*/</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;</span><span style='color:#800000;font-weight:bold; '>return</span><span style='color:#000000;'> </span><span style='color:#797997;'>$result</span><span style='color:#800080;'>;</span><span style='color:#000000;'></span>
<span style='color:#800080;'>}</span><span style='color:#800080;'>;</span><span style='color:#000000;'></span>
<span style='color:#000000;'></span>
<span style='color:#400000;'>var_dump</span><span style='color:#808030;'>(</span><span style='color:#000000;'></span>
<span style='color:#000000;'>&#xa0;&#xa0;</span><span style='color:#797997;'>$get_random_bytes</span><span style='color:#808030;'>(</span><span style='color:#808030;'>)</span><span style='color:#000000;'></span>
<span style='color:#808030;'>)</span><span style='color:#800080;'>;</span><span style='color:#000000;'></span>
<span style='color:#5f5035;'>?&gt;</span>
</pre>

