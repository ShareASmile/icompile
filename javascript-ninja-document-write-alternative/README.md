If you use <code>document.write</code> to write an entire new document,
Chrome might apply a security-policy, warning or even blocking every internal-script you have.

As an alternative, only use <code>document.write</code> to write the <code>doctype</code>,
and set the HTML-source using <code>document.documentElement.innerHTML = "......."</code>.

Here is a working code you, that should be loaded after the document has ready but before it rendered (a.k.a <code>DOMContentLoaded</code> or <code>at_document_end</code> if you are doing this in Chrome's extension).

<!--more-->

<pre>
<span style='color:#696969; '>/* ╔════════════════════════════════════════════════════════════════════╗</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;║ at_document_end                                                    ║</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;╟────────────────────────────────────────────────────────────────────╢</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;║ File's content is injected immediately after the DOM is complete,  ║</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;║ - but before subresources like images and frames have loaded.      ║</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;║ - Like DOMContentLoaded                                            ║</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;╚════════════════════════════════════════════════════════════════════╝</span>
<span style='color:#696969; '>░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ */</span>

<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>function</span> <span style='color:#808030; '>(</span>window<span style='color:#808030; '>,</span> document<span style='color:#808030; '>,</span> doctype<span style='color:#808030; '>,</span> html<span style='color:#808030; '>,</span> is_success_stream<span style='color:#808030; '>)</span><span style='color:#800080; '>{</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>use strict</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>
  <span style='color:#800000; font-weight:bold; '>try</span><span style='color:#800080; '>{</span>html <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>documentElement<span style='color:#808030; '>.</span>cloneNode<span style='color:#808030; '>(</span><span style='color:#0f4d75; '>true</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>innerHTML<span style='color:#800080; '>;</span><span style='color:#800080; '>}</span><span style='color:#800000; font-weight:bold; '>catch</span><span style='color:#808030; '>(</span>err<span style='color:#808030; '>)</span><span style='color:#800080; '>{</span><span style='color:#800080; '>}</span>
  <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>undefined</span><span style='color:#800000; '>"</span> <span style='color:#808030; '>===</span> <span style='color:#800000; font-weight:bold; '>typeof</span> html<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>return</span><span style='color:#800080; '>;</span>

  <span style='color:#800000; font-weight:bold; '>try</span><span style='color:#800080; '>{</span>window<span style='color:#808030; '>.</span>stop<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>document<span style='color:#808030; '>.</span>execCommand<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Stop</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>document<span style='color:#808030; '>.</span>clear<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>document<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span><span style='color:#696969; '>/*document.open();document.close();*/</span>is_success_stream<span style='color:#808030; '>=</span><span style='color:#0f4d75; '>true</span><span style='color:#800080; '>;</span><span style='color:#800080; '>}</span><span style='color:#800000; font-weight:bold; '>catch</span><span style='color:#808030; '>(</span>err<span style='color:#808030; '>)</span><span style='color:#800080; '>{</span><span style='color:#800080; '>}</span>
  <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span><span style='color:#0f4d75; '>true</span> <span style='color:#808030; '>!==</span> is_success_stream<span style='color:#808030; '>)</span>  <span style='color:#800000; font-weight:bold; '>return</span><span style='color:#800080; '>;</span>

  <span style='color:#696969; '>/*</span>
<span style='color:#696969; '>&#xa0;&#xa0;//options #1  - rewrite new stream - good but will render extension's warning!!!</span>
<span style='color:#696969; '>&#xa0;&#xa0;html = doctype + html;  //fix</span>
<span style='color:#696969; '>&#xa0;&#xa0;html = html.replace(/http-equiv\\s*=\\s*[\\'\\"]refresh[\\'\\"]/gi, "done-metarefreshkiller");       </span>
<span style='color:#696969; '>&#xa0;&#xa0;document.open();document.write(html);document.close();  //(TODO: disable this?: chrome://flags/#disallow-doc-written-script-loads</span>
<span style='color:#696969; '>&#xa0;&#xa0;*/</span>
  
  <span style='color:#696969; '>//options #2  - avoid extension's warnings - minimal stream-write (just the doctype), other stuff: '.innerHTML'.</span>
  document<span style='color:#808030; '>.</span>open<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>document<span style='color:#808030; '>.</span>write<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>document<span style='color:#808030; '>.</span>close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
  html <span style='color:#808030; '>=</span> html<span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>replace</span><span style='color:#808030; '>(</span><span style='color:#800000; '>/</span><span style='color:#0000e6; '>http-equiv</span><span style='color:#797997; '>\\s</span><span style='color:#808030; '>*</span><span style='color:#0000e6; '>=</span><span style='color:#797997; '>\\s</span><span style='color:#808030; '>*</span><span style='color:#808030; '>[</span><span style='color:#0f69ff; '>\\'</span><span style='color:#0f69ff; '>\\"</span><span style='color:#808030; '>]</span><span style='color:#0000e6; '>refresh</span><span style='color:#808030; '>[</span><span style='color:#0f69ff; '>\\'</span><span style='color:#0f69ff; '>\\"</span><span style='color:#808030; '>]</span><span style='color:#800000; '>/</span><span style='color:#800000; font-weight:bold; '>gi</span><span style='color:#808030; '>,</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>done-metarefreshkiller</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>       
  document<span style='color:#808030; '>.</span>documentElement<span style='color:#808030; '>.</span>innerHTML <span style='color:#808030; '>=</span> html<span style='color:#800080; '>;</span>

<span style='color:#800080; '>}</span><span style='color:#808030; '>(</span>
  self
<span style='color:#808030; '>,</span> self<span style='color:#808030; '>.</span>document
<span style='color:#808030; '>,</span>
  <span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>function</span><span style='color:#808030; '>(</span>is_empty<span style='color:#808030; '>,</span> EMPTY_STRING<span style='color:#808030; '>,</span> SPACE<span style='color:#808030; '>,</span> doctype<span style='color:#808030; '>)</span><span style='color:#800080; '>{</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>use strict</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>
    <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>&lt;!DOCTYPE##NAME####PUBLIC####PUBLICID####SYSTEM####SYSTEMID####INTERNALSUBSET##></span><span style='color:#800000; '>"</span>
            <span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>replace</span><span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>##NAME##</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span>            <span style='color:#0f4d75; '>true</span> <span style='color:#808030; '>===</span> is_empty<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>.</span>name<span style='color:#808030; '>)</span>           <span style='color:#800080; '>?</span> EMPTY_STRING <span style='color:#800080; '>:</span> SPACE <span style='color:#808030; '>+</span> doctype<span style='color:#808030; '>.</span>name                  <span style='color:#808030; '>)</span>
            <span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>replace</span><span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>##PUBLIC##</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span>          <span style='color:#0f4d75; '>true</span> <span style='color:#808030; '>===</span> is_empty<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>.</span>publicId<span style='color:#808030; '>)</span>       <span style='color:#800080; '>?</span> EMPTY_STRING <span style='color:#800080; '>:</span> SPACE <span style='color:#808030; '>+</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>PUBLIC</span><span style='color:#800000; '>"</span>                      <span style='color:#808030; '>)</span>
            <span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>replace</span><span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>##PUBLICID##</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span>        <span style='color:#0f4d75; '>true</span> <span style='color:#808030; '>===</span> is_empty<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>.</span>publicId<span style='color:#808030; '>)</span>       <span style='color:#800080; '>?</span> EMPTY_STRING <span style='color:#800080; '>:</span> SPACE <span style='color:#808030; '>+</span> <span style='color:#800000; '>'</span><span style='color:#0000e6; '>"</span><span style='color:#800000; '>'</span> <span style='color:#808030; '>+</span> doctype<span style='color:#808030; '>.</span>publicId <span style='color:#808030; '>+</span> <span style='color:#800000; '>'</span><span style='color:#0000e6; '>"</span><span style='color:#800000; '>'</span>  <span style='color:#808030; '>)</span>
            <span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>replace</span><span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>##SYSTEM##</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span>          <span style='color:#0f4d75; '>true</span> <span style='color:#808030; '>===</span> is_empty<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>.</span>systemId<span style='color:#808030; '>)</span>
                                            <span style='color:#808030; '>||</span> <span style='color:#0f4d75; '>false</span> <span style='color:#808030; '>===</span> is_empty<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>.</span>publicId<span style='color:#808030; '>)</span>   <span style='color:#800080; '>?</span> EMPTY_STRING <span style='color:#800080; '>:</span> SPACE <span style='color:#808030; '>+</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>SYSTEM</span><span style='color:#800000; '>"</span>                      <span style='color:#808030; '>)</span>
            <span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>replace</span><span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>##SYSTEMID##</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span>        <span style='color:#0f4d75; '>true</span> <span style='color:#808030; '>===</span> is_empty<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>.</span>systemId<span style='color:#808030; '>)</span>       <span style='color:#800080; '>?</span> EMPTY_STRING <span style='color:#800080; '>:</span> SPACE <span style='color:#808030; '>+</span> <span style='color:#800000; '>'</span><span style='color:#0000e6; '>"</span><span style='color:#800000; '>'</span> <span style='color:#808030; '>+</span> doctype<span style='color:#808030; '>.</span>systemId <span style='color:#808030; '>+</span> <span style='color:#800000; '>'</span><span style='color:#0000e6; '>"</span><span style='color:#800000; '>'</span>  <span style='color:#808030; '>)</span>
            <span style='color:#808030; '>.</span><span style='color:#800000; font-weight:bold; '>replace</span><span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>##INTERNALSUBSET##</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span>  <span style='color:#0f4d75; '>true</span> <span style='color:#808030; '>===</span> is_empty<span style='color:#808030; '>(</span>doctype<span style='color:#808030; '>.</span>internalSubset<span style='color:#808030; '>)</span> <span style='color:#800080; '>?</span> EMPTY_STRING <span style='color:#800080; '>:</span> SPACE <span style='color:#808030; '>+</span> <span style='color:#800000; '>'</span><span style='color:#0000e6; '>[</span><span style='color:#800000; '>'</span> <span style='color:#808030; '>+</span> doctype<span style='color:#808030; '>.</span>systemId <span style='color:#808030; '>+</span> <span style='color:#800000; '>'</span><span style='color:#0000e6; '>]</span><span style='color:#800000; '>'</span>  <span style='color:#808030; '>)</span>
          <span style='color:#800080; '>;</span>
  <span style='color:#800080; '>}</span><span style='color:#808030; '>(</span>
   <span style='color:#800000; font-weight:bold; '>function</span> is_empty<span style='color:#808030; '>(</span>value<span style='color:#808030; '>)</span><span style='color:#800080; '>{</span> <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>undefined</span><span style='color:#800000; '>"</span> <span style='color:#808030; '>===</span> <span style='color:#800000; font-weight:bold; '>typeof</span> value <span style='color:#808030; '>||</span> <span style='color:#0f4d75; '>null</span> <span style='color:#808030; '>===</span> value <span style='color:#808030; '>||</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span> <span style='color:#808030; '>===</span> value<span style='color:#800080; '>;</span> <span style='color:#800080; '>}</span>
  <span style='color:#808030; '>,</span><span style='color:#800000; '>"</span><span style='color:#800000; '>"</span>
  <span style='color:#808030; '>,</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '> </span><span style='color:#800000; '>"</span>
  <span style='color:#808030; '>,</span>self<span style='color:#808030; '>.</span>document<span style='color:#808030; '>.</span>doctype
  <span style='color:#808030; '>,</span><span style='color:#0f4d75; '>undefined</span>
  <span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#808030; '>,</span>
  <span style='color:#0f4d75; '>undefined</span>
<span style='color:#808030; '>,</span>
  <span style='color:#0f4d75; '>undefined</span>
<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
</pre>

The code above is used to stop the loading and rendering of the current document, when executed at the <code>DOMContentLoaded</code> stage (or <code>at_document_end</code> if you're doing this in a Chrome-extension),
then it gets the document's current-doctype (or use a fallback if there is none), modifies the HTML slightly,
and put it back into the document, without actually triggering Chrome's warning/block for <code>Parser-blocking, cross-origin script,  ......, is invoked via document.write. This may be blocked by the browser if the device has poor network connectivity. See https://www.chromestatus.com/feature/5718547946799104 for more details.</code>.

get a fully working example,
github page: <a href="https://github.com/eladkarako/Chrome-Extension-Meta-Refresh-Killer" target="_blank">https://github.com/eladkarako/Chrome-Extension-Meta-Refresh-Killer</a>.
