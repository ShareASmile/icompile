<!DOCTYPE html>
<html encoding="UTF-8" charset="UTF-8" dir="ltr" lang="en-US" xml:lang="en-US" language="English" itemscope="" itemtype="http://schema.org/WebPage" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">

<head>
<!-- ╔════════════════════════════════════════════════╗
     ║ favor latest IE with Chrome-Frame if possible. ║
     ╚════════════════════════════════════════════════╝ -->
  <meta http-equiv="X-UA-Compatible"                   content="IE=edge,chrome=1"                                      />
<!-- ╔════════════════════════════════════════════════════════════╗
     ║ normalize script/style engine with explicit character-set. ║
     ╚════════════════════════════════════════════════════════════╝ -->
  <meta charset="UTF-8"                                                                                                />
  <meta http-equiv="content-type"                      content="text/html;charset=UTF-8"                               />
  <meta http-equiv="Content-Script-Type"               content="text/javascript;charset=UTF-8"                         />
  <meta http-equiv="Content-Style-Type"                content="text/css;charset=UTF-8"                                />
<!-- ╔══════════════════════════════════════════════╗
     ║ bread and butter of mobile-friendly website. ║
     ╚══════════════════════════════════════════════╝ -->
  <meta name="viewport"                                content="width=device-width,initial-scale=1.0,shrink-to-fit=no,minimal-ui"                                           />
<!-- ╔════════════════════════════╗
     ║ poor's man's HTTP-Headers. ║
     ╚════════════════════════════╝ -->
  <meta http-equiv="Feature-Policy"                    content="fullscreen *; wake-lock *; vibrate *; geolocation *;"  />
  <meta http-equiv="Cache-Control"                     content="public,max-age=1800,max-stale,stale-while-revalidate=86400,stale-if-error=259200" rem="max-age=30minutes"   />
  <meta http-equiv="X-Content-Type-Options"            content="nosniff"                                               />
  <meta http-equiv="X-DNS-Prefetch-Control"            content="on"                                                    />
<!-- needs more work... 
  <meta http-equiv="Content-Security-Policy"           content="default-src 'none'; base-uri 'self'; block-all-mixed-content; connect-src 'self' icompile.eladkarako.com eladkarako.com eladkarako.github.io www.google.com www.google-analytics.com www.googletagmanager.com www.github.com gist.github.com gist.githubusercontent.com; font-src github.githubassets.com; form-action 'none; frame-ancestors 'self'; frame-src 'self' render.githubusercontent.com gist.github.com; img-src 'self' *.imgur.com data: *.githubusercontent.com; media-src 'none'; script-src 'self' github.githubassets.com; style-src 'unsafe-inline' github.githubassets.com; worker-src 'none'"                                                                                                         />
-->  
  <meta http-equiv="X-XSS-Protection"                  content="1; mode=block"                                         />
<!-- ╔════════════════════════════════════╗
     ║ disable browser annoying features. ║
     ╚════════════════════════════════════╝ -->
  <meta name="format-detection"                        content="telephone=no,date=no,address=no,email=no,url=no"       />
  <meta http-equiv="imagetoolbar"                      content="no"                                                    />
  <meta http-equiv="cleartype"                         content="on"                                                    />
  <meta http-equiv="Page-Enter"                        content="RevealTrans(Duration=0.0,Transition=0.0)"              />
  <meta http-equiv="Page-Exit"                         content="RevealTrans(Duration=0.0,Transition=0.0)"              />
  <!-----------------------------------------------------------------------do not modify line below here, an installed skype read it AS IS (you need to make the HTML is UTF-8 (no BOM) with Windown EOL). -->
  <meta name="SKYPE_TOOLBAR" content="SKYPE_TOOLBAR_PARSER_COMPATIBLE">
  <!--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
<!-- ╔══════════════════════════════════╗
     ║ compatible with viewport for IE. ║
     ╚══════════════════════════════════╝ -->
  <meta name="HandheldFriendly"                        content="True"              />
  <meta name="MSThemeCompatible"                       content="no"                />
  <meta name="theme-color"                             content="#b1cff4"           />
  <meta name="mssmarttagspreventparsing"               content="true"              />
  <meta name="apple-mobile-web-app-capable"            content="yes"               />
  <meta name="apple-mobile-web-app-status-bar-style"   content="translucent black" />
  <meta name="msapplication-navbutton-color"           content="translucent black" />
<!-- ╔══════════╗
     ║ audience ║
     ╚══════════╝ -->
  <meta name="target"                                  content="all"               />
  <meta name="audience"                                content="all"               />
  <meta name="coverage"                                content="Worldwide"         />
  <meta name="distribution"                            content="Global"            />
  <meta name="rating"                                  content="safe for kids"     />
<!-- ╔══════════╗
     ║ language ║
     ╚══════════╝ -->
  <meta http-equiv="Content-Language"                  content="en-US"             />
  <meta property="og:locale"                           content="en_US"             />
  <meta name="language"                                content="English"           />
  <meta name="og:type"                                 content="article"           />
<!-- ╔═══════════════════════════════╗
     ║ site-name and author contact. ║
     ╚═══════════════════════════════╝ -->
  <meta property="og:site_name"                        content="iCompile"          />
  <meta name="article:author"                          content="Elad Karako"       />
  <meta name="author"                                  content="Elad Karako"       />
  <meta name="owner"                                   content="Elad Karako"       />
  <meta name="contactName"                             content="Elad Karako"       />
  <meta name="dcterms.creator"                         content="Elad Karako"       />
  <link rel="me"                                       href="https://github.com/eladkarako/"  type="text/html"  />
  <link rel="author"                                   href="https://github.com/eladkarako/"                    />
  <link rel="profile"                                  href="https://gmpg.org/xfn/11"                           />
  <meta name="dcterms.type"                            content="Text"              />
  <meta name="dcterms.format"                          content="text/html"         />  
<!-- ╔═════════════════════════════════════╗
     ║ specific page information - title . ║
     ╚═════════════════════════════════════╝ -->
  <title>VB6 API For CoInitializeEx and CoUninitialize of ole32.dll</title>
  <meta itemprop="name"                                content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="dcterms.title"                           content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta property="og:title"                            content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="twitter:title"                           content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="twitter:text:title"                      content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="application-name"                        content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="subject"                                 content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="apple-mobile-web-app-title"              content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="msapplication-tooltip"                   content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
<!-- ╔══════════════════════════════════════════════════════════════╗
     ║ specific page information - description (title is fine too). ║
     ╚══════════════════════════════════════════════════════════════╝ -->
  <meta name="description"                             content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta itemprop="description"                         content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="dcterms.description"                     content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta name="twitter:description"                     content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
  <meta property="og:description"                      content="VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"       />
<!-- ╔═══════════╗
     ║ keywords. ║
     ╚═══════════╝ -->
  <meta property="keywords"                            content="apartment,arguments,aspx,bold,boolean,byval,call,calling,calls,change,changed,close,closes,coihr,coinit,color,concurrency,connections,created,creates,cstr,debuging,declare,determines,disable,disables,dlls,doevents,dwcoinit,elad,elseif,enum,enumeration,explained,false,font,forces,frees,function,hresult,incoming,initialized,initializes,invalid,invalidarg,karako,library,loaded,maintains,memory,ment,microsoft,mode,model,msdn,msgbox,multi,multithread,neutral,node,object,objects,occurred,option,optional,outofmemory,private,public,pvreserved,referenced,required,resources,satisfying,sets,single,speed,strings,support,task,thread,threaded,tostring,trade,unexpected,unknown,unloads,weight,winerror,eladkarako,eladkarakomod,icompile,Elad Karako,Karako Elad,אלעד קרקו,קרקו אלעד,קרקו"    />
  <meta property="article:tag"                         content="apartment,arguments,aspx,bold,boolean,byval,call,calling,calls,change,changed,close,closes,coihr,coinit,color,concurrency,connections,created,creates,cstr,debuging,declare,determines,disable,disables,dlls,doevents,dwcoinit,elad,elseif,enum,enumeration,explained,false,font,forces,frees,function,hresult,incoming,initialized,initializes,invalid,invalidarg,karako,library,loaded,maintains,memory,ment,microsoft,mode,model,msdn,msgbox,multi,multithread,neutral,node,object,objects,occurred,option,optional,outofmemory,private,public,pvreserved,referenced,required,resources,satisfying,sets,single,speed,strings,support,task,thread,threaded,tostring,trade,unexpected,unknown,unloads,weight,winerror,eladkarako,eladkarakomod,icompile,Elad Karako,Karako Elad,אלעד קרקו,קרקו אלעד,קרקו"    />
<!-- ╔════════════════════════════════════════════════╗
     ║ relation: next/previous/first/last pages.      ║
     ║ (although not advised a single page-article).  ║
     ╚════════════════════════════════════════════════╝ -->
  <link rel="start"                                       href="https://icompile.eladkarako.com/show-hidden-devices-in-windows-device-manager"       />
  <link rel="prev"                                        href="https://icompile.eladkarako.com/13-31-113-131-311-prime-numbers"    />
  <link rel="previous"                                    href="https://icompile.eladkarako.com/13-31-113-131-311-prime-numbers"    />
  <link rel="next"                                        href="https://icompile.eladkarako.com/window-messeging-example"        />
  <link rel="last"                                        href="https://icompile.eladkarako.com/shealth"        />
  <link rel="up"                                          href="https://icompile.eladkarako.com/" />
  <base target="_top"                                     href="https://icompile.eladkarako.com/" />
<!-- ╔══════╗
     ║ URL. ║
     ╚══════╝ -->
  <link rel="canonical"                                   href="https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"         />
  <meta property="og:url"                              content="https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"         />
  <meta name="twitter:url"                             content="https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"         />
  <meta name="identifier-URL"                          content="https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"         />
  <meta name="msapplication-starturl"                  content="https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"         />
  <meta name="dcterms.identifier"                      content="https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"         />
<!-- ╔════════════════════════════════╗
     ║ Data and Time - UTC. Creation. ║
     ╚════════════════════════════════╝ -->
  <meta name="creation_date"                           content="2010-10-31T11:10:43+00:00"     />
  <meta name="page-datetime"                           content="2010-10-31T11:10:43+00:00"     />
  <meta property="article:published_time"              content="2010-10-31T11:10:43+00:00"     />
  <meta name="dcterms.date"                            content="2010-10-31T11:10:43+00:00"     />
<!-- ╔═════════════════════════════════════╗
     ║ Data and Time - UTC. Last-Modified. ║
     ╚═════════════════════════════════════╝ -->
  <meta name="dcterms.modified"                        content="2016-08-02T03:21:36+00:00"    />
  <meta property="article:modified_time"               content="2016-08-02T03:21:36+00:00"    />
<!-- ╔═════════════════════════════════════════╗
     ║ License - FREE FOR ALL - PUBLIC-DOMAIN! ║
     ╚═════════════════════════════════════════╝ -->
  <link rel="license"                                     href="https://icompile.eladkarako.com/LICENSE" />
<!-- ╔════════════════════╗
     ║ preconnect (self)  ║
     ╚════════════════════╝ -->
  <link rel="dns-prefetch"   crossorigin="anonymous"                                                                                     href="https://icompile.eladkarako.com"                             />
  <link rel="preconnect"     crossorigin="anonymous"                                                                                     href="https://icompile.eladkarako.com"                             />
<!-- ╔═══════════════════════╗
     ║ preconnect (external) ║
     ╚═══════════════════════╝ -->
  <link rel="dns-prefetch"   crossorigin="anonymous"                                                                                     href="https://utteranc.es"                                         />
  <link rel="preconnect"     crossorigin="anonymous"                                                                                     href="https://utteranc.es"                                         />
  <link rel="dns-prefetch"   crossorigin="anonymous"                                                                                     href="www.googletagmanager.com"                                    />
  <link rel="preconnect"     crossorigin="anonymous"                                                                                     href="www.googletagmanager.com"                                    />
  <!-- not being used right now... 
  <link rel="dns-prefetch"   crossorigin="anonymous"                                                                                     href="www.google-analytics.com"                                    />
  <link rel="preconnect"     crossorigin="anonymous"                                                                                     href="www.google-analytics.com"                                    />
  <link rel="dns-prefetch"   crossorigin="anonymous"                                                                                     href="ssl.google-analytics.com"                                    />
  <link rel="preconnect"     crossorigin="anonymous"                                                                                     href="ssl.google-analytics.com"                                    />
  -->
<!-- ╔═════════════════╗
     ║ preload (self)  ║
     ╚═════════════════╝ -->
  <link rel="preload"        crossorigin="anonymous"        type="image/x-icon"                           as="image"                     href="https://icompile.eladkarako.com/favicon.ico"                 />
  <link rel="preload"        crossorigin="anonymous"        type="text/css"               charset="UTF-8" as="style"                     href="https://icompile.eladkarako.com/_resources/index.css"        />
  <link rel="preload"        crossorigin="anonymous"        type="text/javascript"        charset="UTF-8" as="script"                    href="https://icompile.eladkarako.com/_resources/index.js"         />
<!-- ╔════════════════════╗
     ║ preload (external) ║
     ╚════════════════════╝ -->
  <link rel="preload"        crossorigin="anonymous"  type="text/javascript"        charset="UTF-8" as="script"                          href="https://utteranc.es/client.js"                               />
  <link rel="preload"        crossorigin="anonymous"  type="text/javascript"        charset="UTF-8" as="script"                          href="https://www.googletagmanager.com/gtag/js?id=G-M28VNCZS3P"    />
<!-- ╔══════╗
     ║ load ║
     ╚══════╝ -->
  <link rel="icon"           crossorigin="anonymous"        type="image/x-icon"                                                                href="https://icompile.eladkarako.com/favicon.ico" />
  <link rel="shortcut icon"  crossorigin="anonymous"        type="image/x-icon"                                                                href="https://icompile.eladkarako.com/favicon.ico" />
<!-- ╔════════════════════════════════════════════════╗
     ║ page specific image (but favicon is fine too). ║
     ╚════════════════════════════════════════════════╝ -->
  <meta itemprop="image"                                    type="image/png"                                                                content="https://icompile.eladkarako.com/favicon.png" />
  <meta property="og:image"                                 type="image/png"                                                                content="https://icompile.eladkarako.com/favicon.png" />
  <link rel="apple-touch-icon image_src"                    type="image/png"                                                                   href="https://icompile.eladkarako.com/favicon.png" />
  <link rel="stylesheet"     crossorigin="anonymous"        type="text/css"               charset="UTF-8" media="all"                          href="https://icompile.eladkarako.com/_resources/index.css"   />
<!-- ╔══════════════════════════════════════════════════════╗
     ║ OpenSearch (as en external file). type is important. ║
     ╚══════════════════════════════════════════════════════╝ -->
  <link rel="search"                                   href="https://icompile.eladkarako.com/opensearch.xml" type="application/opensearchdescription+xml" title="Search icompile.eladkarako.com" charset="UTF-8" />
<!-- ╔═══════════════════════════════════════╗
     ║ micro-data in a schema-friendly JSON. ║
     ╚═══════════════════════════════════════╝ -->
  <script type="application/ld+json">
{"@context"        : "http://schema.org/"
,"@type"           : "WebSite"
,"name"            : "iCompile"
,"alternateName"   : "iCompile"
,"@id"             : "https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"
,"url"             : "https://icompile.eladkarako.com/vb6-api-for-coinitializeex-and-couninitialize-of-ole32-dll"
,"headline"        : "VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"
,"description"     : "VB6 API For CoInitializeEx and CoUninitialize of ole32.dll"
,"datePosted"      : "2010-10-31T11:10:43+00:00"
,"dateCreated"     : "2010-10-31T11:10:43+00:00"
,"datePublished"   : "2010-10-31T11:10:43+00:00"
,"dateModified"    : "2016-08-02T03:21:36+00:00"
,"thumbnailUrl"    : "https://icompile.eladkarako.com/favicon.png"
,"image"           : {"@type"       : "ImageObject"
                     ,"url"         : "https://icompile.eladkarako.com/favicon.png"
                     ,"width"       : 152
                     ,"height"      : 152
                     }
,"potentialAction" : {"@type"       : "SearchAction"
                     ,"target"      : "https://www.google.com/search/?q={query}%20site%3Ahttps%3A%2F%2Ficompile.eladkarako.com%2F"
                     ,"query"       : "required"
                     }
,"author"          : {"@type"       : "Person"
                     ,"name"        : "Elad Karako"
                     ,"givenName"   : "Elad"
                     ,"familyName"  : "Karako"
                     ,"jobTitle"    : "Software Engineer"
                     }
,"license"         : "https://icompile.eladkarako.com/LICENSE"
}
  </script>
<!-- ╔════════════════════╗
     ║ Analytics (no JS). ║
     ╚════════════════════╝ -->
  <noscript><iframe          crossorigin="anonymous"  type="text/html"              charset="UTF-8" loading="eager" lazyload="off"        src="https://www.googletagmanager.com/ns.html?id=G-M28VNCZS3P" referrerpolicy="unsafe-url" sandbox="allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation" seamless="false" height="0" width="0" style="display:none;"></iframe></noscript>
</head>
<body role="main">

<article id="post-0003443258821">
  <header>
    <h1 itemprop="headline">VB6 API For CoInitializeEx and CoUninitialize of ole32.dll</h1>
    <sup>Posted at <time datetime="2016-08-02T03:21:36+00:00" itemprop="dateModified">Tue, 02 Aug 2016 03:21:36 GMT</time></sup>
  </header>
  <br/>
  <div itemprop="articleBody"><pre><span style='color:#800000; font-weight:bold; '>Option Explicit</span><br/>
<span style='color:#696969; '>'Satisfying API For CoInitializeEx and CoUninitialize of ole32.dll</span><br/>
<span style='color:#696969; '>'Explained and MSDN referenced.</span><br/>
<span style='color:#696969; '>' Elad Karako</span><br/>
<br/>
<span style='color:#800000; font-weight:bold; '>Private</span> Enum COINIT_HRESULT<br/>
    S_OK <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H0</span><span style='color:#808030; '>&amp;</span>  <span style='color:#696969; '>'The COM library was initialized successfully on this thread.</span><br/>
    S_FALSE <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H1</span><span style='color:#808030; '>&amp;</span> <span style='color:#696969; '>'The COM library is already initialized on this thread.</span><br/>
    RPC_E_CHANGED_MODE <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H80010106</span>   <span style='color:#696969; '>'A previous call to CoInitializeEx specified the concurrency model for this thread as multithread apartment (MTA). This could also indicate that a change from neutral-threaded apartment to single-threaded apartment has occurred.</span><br/>
    E_INVALIDARG <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H80070057</span> <span style='color:#696969; '>'One or more arguments are invalid.</span><br/>
    E_OUTOFMEMORY <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H80000002</span> <span style='color:#696969; '>'Ran out of memory.</span><br/>
    E_UNEXPECTED <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H80041316</span> <span style='color:#696969; '>'The task XML contains an unexpected node.</span><br/>
<span style='color:#800000; font-weight:bold; '>End</span> Enum<br/>
<br/>
<span style='color:#696969; '>'COINIT Enumeration</span><br/>
<span style='color:#696969; '>'Determines the concurrency model used for incoming calls to objects created by this thread. This concurrency model can be either apartment-threaded or multi-threaded.</span><br/>
<span style='color:#696969; '>'see http://msdn.microsoft.com/en-us/library/ms678505(v=VS.85).aspx</span><br/>
<span style='color:#696969; '>'</span><br/>
<span style='color:#696969; '>'YOU SHOULD ONLY USE COINIT_APARTMENTTHREADED or COINIT_MULTITHREADED.</span><br/>
<span style='color:#800000; font-weight:bold; '>Private</span> Enum COINIT<br/>
  COINIT_APARTMENTTHREADED <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H2</span> <span style='color:#696969; '>'Initializes the thread for apartment-threaded object concurrency.</span><br/>
  COINIT_MULTITHREADED <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H0</span> <span style='color:#696969; '>'Initializes the thread for multi-threaded object concurrency.</span><br/>
  COINIT_DISABLE_OLE1DDE <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H4</span> <span style='color:#696969; '>'Disables DDE for OLE1 support.</span><br/>
  COINIT_SPEED_OVER_MEMORY <span style='color:#808030; '>=</span> <span style='color:#008c00; '>&amp;H8</span> <span style='color:#696969; '>'Trade memory for speed.</span><br/>
<span style='color:#800000; font-weight:bold; '>End</span> Enum<br/>
<br/>
<span style='color:#696969; '>'CoInitializeEx Function</span><br/>
<span style='color:#696969; '>'Initializes the COM library for use by the calling thread, sets the thread's concurrency model, and creates a new apartment for the thread if one is required.</span><br/>
<span style='color:#696969; '>'see http://msdn.microsoft.com/en-us/library/ms695279(v=VS.85).aspx</span><br/>
<span style='color:#800000; font-weight:bold; '>Private</span> Declare <span style='color:#800000; font-weight:bold; '>Function</span> CoInitializeEx Lib <span style='color:#0000e6; '>"ole32.dll"</span> <span style='color:#808030; '>(</span> <span style='color:#800000; font-weight:bold; '>_</span><br/>
    <span style='color:#800000; font-weight:bold; '>ByVal</span> pvReserved <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Long</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>_</span><br/>
    <span style='color:#800000; font-weight:bold; '>ByVal</span> dwCoInit <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Long</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>As</span> COINIT_HRESULT<br/>
<br/>
<span style='color:#696969; '>'CoUninitialize Function</span><br/>
<span style='color:#696969; '>'Closes the COM library on the current thread, unloads all DLLs loaded by the thread, frees any other resources that the thread maintains, and forces all RPC connections on the thread to close.</span><br/>
<span style='color:#696969; '>'see http://msdn.microsoft.com/en-us/library/ms688715(v=VS.85).aspx</span><br/>
<span style='color:#800000; font-weight:bold; '>Private</span> Declare <span style='color:#800000; font-weight:bold; '>Function</span> CoUninitialize Lib <span style='color:#0000e6; '>"ole32.dll"</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><br/>
<br/>
<br/>
<span style='color:#696969; '>''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''</span><br/>
<span style='color:#696969; '>''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''</span><br/>
<br/>
<br/>
<span style='color:#696969; '>'CoInitializeEx Function</span><br/>
<span style='color:#696969; '>'Initializes the COM library for use by the calling thread, sets the thread's concurrency model, and creates a new apartment for the thread if one is required.</span><br/>
<span style='color:#696969; '>'see http://msdn.microsoft.com/en-us/library/ms695279(v=VS.85).aspx</span><br/>
<span style='color:#800000; font-weight:bold; '>Public</span> <span style='color:#800000; font-weight:bold; '>Sub</span> do_CoInitializeEx<span style='color:#808030; '>(</span>Optional c <span style='color:#800000; font-weight:bold; '>As</span> COINIT <span style='color:#808030; '>=</span> COINIT_APARTMENTTHREADED<span style='color:#808030; '>,</span> Optional bDebugResult <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Boolean</span> <span style='color:#808030; '>=</span> <span style='color:#0f4d75; '>False</span><span style='color:#808030; '>)</span><br/>
    <span style='color:#800000; font-weight:bold; '>Dim</span> coihr <span style='color:#800000; font-weight:bold; '>As</span> COINIT_HRESULT<br/>
    coihr <span style='color:#808030; '>=</span> CoInitializeEx<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>ByVal</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>&amp;</span><span style='color:#808030; '>,</span> c<span style='color:#808030; '>)</span><br/>
    <span style='color:#800000; font-weight:bold; '>If</span> <span style='color:#808030; '>(</span>bDebugResult<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>Then</span> <span style='color:#800000; font-weight:bold; '>MsgBox</span> toString<span style='color:#808030; '>(</span>coihr<span style='color:#808030; '>)</span><br/>
    <span style='color:#800000; font-weight:bold; '>DoEvents</span><br/>
<span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Sub</span><br/>
<br/>
<span style='color:#696969; '>'CoUninitialize Function</span><br/>
<span style='color:#696969; '>'Closes the COM library on the current thread, unloads all DLLs loaded by the thread, frees any other resources that the thread maintains, and forces all RPC connections on the thread to close.</span><br/>
<span style='color:#696969; '>'see http://msdn.microsoft.com/en-us/library/ms688715(v=VS.85).aspx</span><br/>
<span style='color:#800000; font-weight:bold; '>Public</span> <span style='color:#800000; font-weight:bold; '>Sub</span> do_CoUninitialize<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><br/>
    CoUninitialize<br/>
    <span style='color:#800000; font-weight:bold; '>DoEvents</span><br/>
<span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Sub</span><br/>
<br/>
<span style='color:#696969; '>'ment for debuging the result of CoInitializeEx Function,</span><br/>
<span style='color:#696969; '>'strings are from WinError.h and MSDN</span><br/>
<span style='color:#800000; font-weight:bold; '>Private</span> <span style='color:#800000; font-weight:bold; '>Function</span> toString<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>ByVal</span> coihr <span style='color:#800000; font-weight:bold; '>As</span> COINIT_HRESULT<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>String</span><br/>
    <span style='color:#800000; font-weight:bold; '>If</span> <span style='color:#808030; '>(</span>coihr <span style='color:#808030; '>=</span> HRESULT<span style='color:#008c00; '>.</span>S_OK<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>Then</span><br/>
        HRESULT_toString <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"S_OK: The COM library was initialized successfully on this thread."</span><br/>
    <span style='color:#800000; font-weight:bold; '>ElseIf</span> <span style='color:#808030; '>(</span>coihr <span style='color:#808030; '>=</span> HRESULT<span style='color:#008c00; '>.</span>S_FALSE<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>Then</span><br/>
        HRESULT_toString <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"S_FALSE: The COM library is already initialized on this thread."</span><br/>
    <span style='color:#800000; font-weight:bold; '>ElseIf</span> <span style='color:#808030; '>(</span>coihr <span style='color:#808030; '>=</span> HRESULT<span style='color:#008c00; '>.</span>RPC_E_CHANGED_MODE<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>Then</span><br/>
        HRESULT_toString <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"RPC_E_CHANGED_MODE: A previous call to CoInitializeEx specified the concurrency model for this thread as multithread apartment (MTA). This could also indicate that a change from neutral-threaded apartment to single-threaded apartment has occurred."</span><br/>
    <span style='color:#800000; font-weight:bold; '>ElseIf</span> <span style='color:#808030; '>(</span>coihr <span style='color:#808030; '>=</span> HRESULT<span style='color:#008c00; '>.</span>E_INVALIDARG<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>Then</span><br/>
        HRESULT_toString <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"E_INVALIDARG: One or more arguments are invalid."</span><br/>
    <span style='color:#800000; font-weight:bold; '>ElseIf</span> <span style='color:#808030; '>(</span>coihr <span style='color:#808030; '>=</span> HRESULT<span style='color:#008c00; '>.</span>E_OUTOFMEMORY<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>Then</span><br/>
        HRESULT_toString <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"E_OUTOFMEMORY: Ran out of memory."</span><br/>
    <span style='color:#800000; font-weight:bold; '>ElseIf</span> <span style='color:#808030; '>(</span>coihr <span style='color:#808030; '>=</span> HRESULT<span style='color:#008c00; '>.</span>E_UNEXPECTED<span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>Then</span><br/>
        HRESULT_toString <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"E_UNEXPECTED: The task XML contains an unexpected node."</span><br/>
    <span style='color:#800000; font-weight:bold; '>Else</span><br/>
        HRESULT_toString <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>CStr</span><span style='color:#808030; '>(</span>coihr<span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span> <span style='color:#0000e6; '>"(?) Unknown."</span><br/>
    <span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>If</span><br/>
<span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Function</span><br/>
</pre></div>
  <br/>
  <br/>
  <br/>
  <footer>
    <center><a rel="first" title="First Article" itemprop="relatedLink" href="https://icompile.eladkarako.com/show-hidden-devices-in-windows-device-manager">&vert;&lt;</a>&nbsp;<a rel="previous" title="Previous Article" itemprop="relatedLink" href="https://icompile.eladkarako.com/13-31-113-131-311-prime-numbers">&lt;</a>&nbsp;<a rel="index" title="Home-Page" itemprop="relatedLink" href="https://icompile.eladkarako.com/">&Hat;</a>&nbsp;<a rel="next" title="Next Article" itemprop="relatedLink" href="https://icompile.eladkarako.com/window-messeging-example">&gt;</a>&nbsp;<a rel="last" title="Last Article" itemprop="relatedLink" href="https://icompile.eladkarako.com/shealth">&gt;&vert;</a></center>
    <br/>
    <table>
      <thead>
        <tr><td colspan="2">Next Articles</td></tr>
      </thead>
      <tbody>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/window-messeging-example">JavaScript Snippet - WordPress Window-Messaging Semi-Safe Example</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/javascript-snippet-robtex-com-sorted-lists">JavaScript Snippet - Robtex.com Sorted Lists</a></td></tr>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/new-wordpress-plugin-tagclass-bgone">New WordPress Plugin - TagClass-B-Gone</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/wordpress-script-style-killer">New WordPress Plugin - Script-Style-Killer</a></td></tr>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/web-whatsapp-com-resources-inline-style-zero-and-custom">web.whatsapp.com Resources - Inline-Style - Zero And Custom</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/whatsapp-new-emoji-from-web-whatsapp-com">Whatsapp New Emoji - From web.whatsapp.com</a></td></tr>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/whatsapp-new-emoji-from-android-apk">Whatsapp New Emoji – From Android-APK</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/firefox-disgrace">Firefox Is A F***ing Disgrace</a></td></tr>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/javascript-specific-base64-snippet">JavaScript Snippet - Specific Base64 Bookmarklet</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/apache-htaccess-entry-for-serving-correct-mimetype-for-some-of-the-more-common-file-types">Apache .htaccess Entry For Serving Correct MimeType For Some Of The More Common File-Types</a></td></tr>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/html5-checkbox">HTML5 Ninja - Custom CheckBox</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/rain-in-israel-%e2%98%94-in-the-middle-of-august%e2%98%80-wtf">Rain In Israel! ☔ In The Middle Of August?☀ WTF???</a></td></tr>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/notepad2-encoding-and-eol-defaults">Notepad2 Encoding And EOL Defaults</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/microsoft-urls-used-by-background-services-you-can-not-block-with-hosts-file">Microsoft URLS Used By Background Services You Can-Not Block With HOSTS-File</a></td></tr>
        <tr><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/enable-http2">Enable HTTP/2 On Chrome</a></td><td><a itemprop="relatedLink" href="https://icompile.eladkarako.com/pokemod">PokéMod</a></td></tr>
      </tbody>
    </table>
  </footer>
</article>
<br/>
<hr/>
<br/>


<br/>
<script defer="defer"        crossorigin="anonymous"  type="text/javascript"        charset="UTF-8" loading="eager" lazyload="off"        src="https://icompile.eladkarako.com/_resources/index.js"></script>
</body>
</html>